## 4.1 조건 확인 함수

### 특정 값의 일치 여부 확인

- 인자로 전달받은 값의 유효성 검사

- `check()` 함수와 `require()` 함수

  - `check()` 함수 : `IllegalStateException` 발생
  - `require()` 함수 : `IllegalArgumentException` 발생

- 두 함수의 호출 이후 어떤 행동을 할지도 지정할 수 있는 함수 제공

- 예제

  ```kotlin
  fun showMessage(isPrepared: Boolean, message: String) {
    // isPrepared가 false면 IllegalStateException 발생
    check(isPrepared)
    // 문자 길이가 10이하면 IllegalArgumentException 발생
    require(message.length > 10)
    println(message)
  }
  ```

### 명시적으로 실행 중단하기

- 임의로 예외를 발생시커나 해야 할 일 명시

- `error()` 함수와 `TODO()` 함수

  - `error()` 함수 : `IllegalStateException` 발생
  - `TODO()` 함수 : `NotImplementedError` 발생 

- 예제

  ```kotlin
  fun showMessage(isPrepared: Boolean, message: String) {
    if (!isPrepared) {
      error("Not prepared yet")
    }
    println(message)
  }
  ```

  ```kotlin
  class Car {
    fun drive() {
      ...
    }
    
    fun stop() {
      TODO("Brake is not implemented")
    }
  }
  ```

## 4.2 컬렉션 생성 함수

### 배열

- `arrayOf()` 함수를 사용하여 특정 원소를 담고 있는 배열 생성 가능

- `emptyArrayOf()` 함수를 사용하여 빈배열 생성 가능

- Java primitive type을 포함하는 함수 생성 가능

  - `booleanArrayOf()`
  - `byteArrayOf()`
  - `charArrayOf()`
  - `doubleArrayOf()`
  - `floatArrayOf()`
  - `intArrayOf()`
  - `longArrayOf()`
  - `shortArrayOf()`

- 예제

  ```kotlin
  val chars = charArrayOf('a', 'b', 'c', 'd', 'e')
  val numbers = intArrayOf(1, 2, 3, 4, 5)
  ```

### 리스트

- __읽기 전용 리스트__는 `listOf()` 함수 사용하여 생성 가능
- `null` 값을 무시한 읽기 전용 리스트는 `listOfNotNull()` 함수 사용
- __수정 가능한 리스트__는 `mutableListOf()` 함수 사용
- 자바 `ArrayList` 생성은 `arrayListOf()` 함수 사용

### 맵

- 기본 룰은 리스트 생성과 동일

- 맵에 들어갈 요소는 `Pair` 형태로 받는데, 표준 라이브러리의 `to()` 함수를 사용하면 직관적 표현 가능

  ```kotlin
  val cities1 = mapOf(Pair("SEO", "Seoul"), Pair("TOK", "Tokyo"), ...)
  val cities2 = mapOf("SEO" to "Seoul", "TOK" to "Tokyo", ...)
  ```

- 명시적 타입의 맵을 생성하는 함수도 제공

  - `hashMapOf()`
  - `linkedMapOf()`
  - `sortedMapOf()`

### 집합

- 기본 룰은 리스트와 맵과 동일
- 맵과 마찬가지로 명시적 타입 집합을 생서하는 함수 제공

## 4.3 스트림 함수

- 자바 8에서는 컬렉션에 포함된 자료를 쉽게 다룰 수 있는 스트림 기능 제공
- 코틀린에서는 스트림과 유사한 표준 라이브러리 함수 제공

### 변환

- `map()` 함수는 컬렉션 내 인자를 다른 값 혹은 타입으로 변환할 때 사용

- 예제

  ```kotlin
  val cities = listOf("Seoul", "Tokyo", ...)

  // 각 인자를 대문자로 변환
  cities.map { city -> city.toUpperCase() }
    .forEach { println(it) }

  // 각 인자를 문자열 길이로 변환
  cities.map { city -> city.length }
    .forEach { println("length=$it") }
  ```

- `mapIndexed()` 함수는 컬렉션 내 포함된 인자의 인덱스 값을 함수 내에서 사용 가능

- 예제

  ```kotlin
  val numbers = 0..10

  // 인자와 인덱스를 곱한 값 반환
  numbers.mapIndexed { idx, number -> idx * number }
    .forEach { print("$it") }
  ```

- `mapNotNull()` 함수는 인자 변환과 동시에 변환 결과가 `null`인 경우 무시

- `flatMap()` 함수는 `map()` 함수와 달리 반환형이 `Iterable`

- `groupBy()` 함수는 컬랙션 내 인자들을 지정한 기준에 따라 분류 맵 형태로 반환

- 예제

  ```kotlin
  val cities = listOf("Seoul", "Tokyo", ...)
  cities.groupBy { city -> if (city.length <= 5) "A" else "B" }
    .forEach { key, cities -> println("key=$key cities=$cities") }
  ```

### 필터

- `filter()` 함수는 컬렉션 내 인자들 중 조건과 일치하는 인자만 걸러주는 역할

- 예제

  ```kotlin
  val cities = listOf("Seoul", "Tokyo", ...)
  cities.filter { city -> city.length <= 5 }
    .forEach{ println(it) }
  ```

- `take()` 함수는 인자로 받은 개수만큼을 인자로 갖는 리스트를 반환

  - `takeLast()` 함수 : 뒤에서 부터 시작
  - `takeWhile()` 함수 : 조건에 만족하는 동안에만 반환될 리스트에 인자로 포함시킴

- `drop()` 함수는 `take()` 함수와 반대

- `first()` 함수

  - 리스트 내에 첫 번째 인자 반환
  - 특정 조건을 만족하는 첫 번째 인자 반환

- `last()` 함수는 `first()` 함수와 반대

- `distinct()` 함수는 컬렉션 내의 중복된 항목을 걸러낸 결과를 반환

  - 중복 여부는 `equals()` 함수로 판단
  - `distinctBy()` 함수를 사용하면 비교할 키 값 설정 가능

### 조합 및 합계

- `zip()` 함수는 두 컬렉션 내의 자료를 조합하여 새로운 자료를 만들 때 사용

- 예제

  ```kotlin
  val cityCodes = listOf("SEO", "TOK", ...)
  val cityNames = listOf("Seoul", "Tokyo", ...)
  cityCodes.zip(cityNames)
    .forEach { pair -> println("${pair.first}:${pair.second}")}
  ```

- `joinToString()` 함수는 컬렉션 내 자료를 문자열 형태로 변환과 동시에 하나의 문자열로 조합할 때 사용

- `count()` 함수는 컬렉션 내 포함된 자료의 개수를 반환
  조건식을 추가하면 해당 조건을 만족하는 자료의 개수 반환

- `reduce()` 함수는 컬렉션 내 자료들을 모두 합쳐 하나의 값으로 만들어 주는 역할
  `joinToString()` 함수의 일종

- `fold()` 함수는 `reduce()` 함수와 동일하나 초기값 지정 가능

### 기타

- `any()` 함수는 컬렉션 내 단 하나의 자료라도 존재한다면 `true` 아니면 `false` 반환
  조건식 추가 가능
- `none()` 함수는 `any()` 함수와 반대 작업 수행, 컬렉션이 비어있는지 여부만 판단
  조건식 추가 가능
- `max()` 함수와 `min()` 함수는 숫자 타입의 자료를 갖는 컬렉션 내에서 각각 최대값 최소값을 찾아 반환
- `average()` 함수는 숫자 타입의 자료를 갖는 컬렉션 내 자료들의 평균을 반환

## 4.4 범위 지정 함수

- 특정 객체에 있는 __함수를 연속 사용__하거나 
  함수의 인자로 전달하기 위해 __변수로 선언한 뒤 다른 곳에서 사용하지 않는 경우__가 있음
- 코틀린에서는 이러한 경우 유용하게 사용할 수 있는 함수들을 표준 라이브러리에서 제공

### `let()` 함수

- 원형

  ```kotlin
  fun <T, R> T.let(block: (T) -> R): R
  ```

  - 함수형 인자 `block`의 인자로 전달 `block` 함수의 결과를 반환

- `let()` 함수를 사용하면 불필요한 변수 선언 방지 가능

- 예제

  ```kotlin
  val padding = TypedValue.applyDimension(...)
  setPadding(padding, 0, padding, 0)

  // let() 함수로 padding 선언 없이 setPadding() 인자로 전달 가능
  TypeValue.applyDienstion(...).toInt().let {
    setPadding(it, 0, it, 0)
  }
  ```

### `apply()` 함수

- 원형

  ```kotlin
  fun <T> T.apply(block: T.() -> Unit): T
  ```

  - 함수형 인자 `block`의 리시버로 전달, 함수를 호출한 객체를 반환

- `apply()` 함수는 이 함수를 호출한 객체를 이어지는 함수 블록의 __리시버로 전달__

  - 리시버로 전달했기 때문에 __객체의 프로퍼티나 함수에 접근 가능__
  - 객체 이름을 일일히 명시하지 않아도 되므로 __코드를 간략하게 만드는데 도움__


### `with()` 함수

- 원형

  ```kotlin
  fun <T, R> with(receiver: T, block: T.() -> R): R
  ```

  - 인자로 받은 객체 receiver를 이어지는 함수형 인자 `block` 의 리시버로 전달, `block` 함수의 결과를 반환

- `with()` 함수는 `let()`, `apply()` 함수와 달리 __사용할 객체를 인자로 전달 받음__
  __인자가 `null`이 아닌 경우에만 사용할 것을 권장__

- 예제

   ```kotlin
  fun manipulateView(messageView: TextView) {
    with(messageView) {
      text = "Hello, World"
      gravity = Gravity.CENTER_HORIZONTAL
    }
  }
   ```

### `run()` 함수

- 원형

  ```kotlin
  fun <R> run(block: () -> R): R
  fun <T, R> T.run(block: T.() -> R): R
  ```

- `run()` 함수는 인자가 없는 익명 함수처럼 사용하는 형태와 객체에서 호출하는 형태를 제공

- 예제

  ```kotlin
  val padding = run {
    val defaultPadding = TypedValue.applyDimension(...)
    val extraPadding = TypedValue.applyDimension(...)
    
    deafultPadding + extraPadding
  }
  ```

  ```kotlin
  override fun onCreate(savedInstanceState: Bundle?) {
    super.onCreate(savedInstanceState)
    
    savedInstanceState?.run {
      ...
    }
  }
  ```